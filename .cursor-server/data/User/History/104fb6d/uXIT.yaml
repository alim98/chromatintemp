# Configuration for training the shape model with our custom dataloaders
experiment_dir: "experiments/shape_model"
device: "cpu" # changed from "cuda" as the PyTorch installation doesn't have CUDA enabled

# Data configuration
data:
  root_dir: data/shapes
  class_csv_path: data/metadata.csv
  num_points: 1024
  cache_dir: data/mesh_cache
  precomputed_dir: null # Set to a directory path if you have precomputed meshes

# Loader configuration
loader:
  batch_size: 8
  shuffle: true
  num_workers: 0

# Model configuration
model:
  name: PointNet
  in_channels: 3
  num_classes: 4
  feature_transform: true

# Optimizer configuration
optimizer:
  name: "Adam"
  kwargs:
    lr: 0.001
    weight_decay: 0.0001

# Criterion configuration (for contrastive learning)
criterion:
  name: "ContrastiveLoss"
  kwargs:
    pos_margin: 0
    neg_margin: 1
    distance:
      function: "CosineSimilarity"

# Training parameters
training:
  loss: CrossEntropyLoss
  learning_rate: 0.001
  weight_decay: 0.0001
  num_epochs: 50
  validate_every: 1
  epochs: 50
  scheduler:
    name: StepLR
    step_size: 20
    gamma: 0.5
  checkpoint_every: 1

# Scheduler configuration
scheduler:
  step_size: 15
  gamma: 0.5

# Wandb configuration
use_wandb: false
wandb_project: MorphoFeatures
wandb_run_name: shape_model_training

output:
  checkpoint_dir: experiments/shape_model/checkpoints
  log_dir: experiments/shape_model/logs
  save_every: 5 